<html>
<head>
  <meta charset="UTF-8">
  <title>Planilha Interativa</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 500px; margin: auto; }
    input, button { margin: 0.5rem 0; width: 100%; padding: 0.5rem; }
    #resposta { margin-top: 1rem; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Interação com a Planilha</h2>
  
  <form id="formulario">
    <input type="text" name="ID" placeholder="ID (obrigatório)" required>
    <input type="text" name="Nome" placeholder="Nome">
    <button type="submit" data-acao="inserir">Inserir</button>
    <button type="submit" data-acao="editar">Editar</button>
    <button type="submit" data-acao="excluir">Excluir</button>
  </form>

  <div id="resposta"></div>

  <script>
    const URL_GS = "https://script.google.com/macros/s/AKfycbz-XkVc--F6-1gMMpNT-m1dCqtAzvPd0j31T_PglDzudsgnNOLATIUXdFTRZGzRJbZPRg/exec";

    document.querySelectorAll("button[type=submit]").forEach(botao => {
      botao.addEventListener("click", e => {
        e.preventDefault();
        const acao = e.target.dataset.acao;
        enviarFormulario(acao);
      });
    });

    async function enviarFormulario(acao) {
      const form = document.getElementById("formulario");
      const formData = new FormData(form);
      const dados = { acao };

      for (const [chave, valor] of formData.entries()) {
        if (valor.trim()) dados[chave] = valor.trim();
      }

      const resposta = await fetch(URL_GS, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(dados)
      });

      const texto = await resposta.text();
      document.getElementById("resposta").textContent = texto;
    }
  </script>
</body>
</html>
